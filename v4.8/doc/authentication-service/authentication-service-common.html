<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Authentication Service </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Authentication Service ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/FrameworkSystemsGmbH/fs/blob/4.8/release/0-beta1/docs/doc/authentication-service/authentication-service-common.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="authentication-service">Authentication Service</h1>

<h2 id="update">Update</h2>
<ol>
<li><p>Sichern Sie den bestehenden Authentication Service in einem neu angelegten Verzeichnis.</p>
</li>
<li><p>Deinstallieren Sie den Windows-Service des bestehenden Authentication Service.
Dazu kann der <em>AuthenticationServiceConfigEditor</em> verwendet werden (siehe <a href="#deinstallation">Deinstallation</a>).</p>
</li>
<li><p>Kopieren Sie die neuen Dateien aus dem Ordner <code>bin\</code> in den Zielordner.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Die Datei <code>AuthenticationService.exe.config</code> im Zielverzeichnis muss erhalten bleiben.
Darin sind alle Konfigurationseinstellungen für den Authentication Service gespeichert.</p>
</div>
</li>
<li><p>Installieren Sie den neuen Authentication Service wie im Abschnitt <a href="#installation">Installation</a> ab 3. beschrieben.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Auch wenn Sie im <em>AuthenticationServiceConfigEditor</em> keine Änderungen vornehmen, speichern Sie in jeden Fall mit der Funktion <em>Save Changes</em>.</p>
</div>
</li>
</ol>
<h3 id="update-der-datenbank">Update der Datenbank</h3>
<p>Bei der Datenbank handelt es sich um ein Repository.
Ein Update auf die entsprechende Framework-Studio Version passiert folgendermaßen:</p>
<ol>
<li>Handelt es sich um ein <strong>Entwicklungs-Repository</strong>, dann erfolgt das Update über Framework Studio.</li>
<li>Bei einem <strong>Runtime-Repository</strong> erfolgt das Update über den Publish Wizard oder Publish2Go Wizard.</li>
</ol>
<h2 id="installation">Installation</h2>
<ol>
<li><p>Erstellen Sie den Zielordner für den Service.<br>
Empfehlung: <code>C:\Programme\enventa Group\FS AuthService\</code></p>
</li>
<li><p>Kopieren Sie den Inhalt des Ordners <code>bin\</code> in den Zielordner.</p>
</li>
<li><p>Jetzt müssen Sie die Konfiguration des Services festlegen.
Führen Sie dazu im Zielordner das Programm <code>AuthenticationServiceConfigEditor.exe</code> aus.
Dieses Programm bearbeitet den Inhalt der Konfigurations-Datei <code>AuthenticationService.exe.config</code>.</p>
<p>Sie erhalten das folgende Bild:</p>
<p><img src="media/General.png" alt="Authentication Service Configuration Editor tab General"></p>
</li>
</ol>
<h3 id="database-connection">Database Connection</h3>
<p>Geben Sie im Abschnitt <strong>Database Connection</strong> die gewünschte Verbindung zu der Datenbank an, in welcher der Service die Benutzerdaten ablegen soll.
Standardmäßig wird dazu das Repository Ihrer Anwendung verwendet.
Mit <em>Test connection</em> können Sie prüfen, ob die angegebene Verbindung zur Datenbank hergestellt werden kann.</p>
<h3 id="service">Service</h3>
<p>Geben Sie im Abschnitt <strong>Service</strong> die folgenden Daten ein:</p>
<h4 id="name">Name</h4>
<p>Geben Sie ggf. einen anderen Namen für den Service an.</p>
<h4 id="id">ID</h4>
<p>Die <em>ID</em> müssen Sie mit <em>Generate ID</em> neu erzeugen. Dabei wird eine absolut eindeutige Guid generiert.</p>
<h4 id="url">URL</h4>
<p>Die <em>URL</em> können Sie mit <em>Set Default</em> auf den eigenen Rechnernamen setzen.
Dort ist z.B. auch eine IP-Adresse möglich.
Es kann ein anderer Port als <code>20001</code> verwendet werden.
Dann müssen die Konfigurationen der Clients, die mit dem Service kommunizieren sollen, auf den geänderten Port angepasst werden.</p>
<h4 id="private-key--public-key">Private Key / Public Key</h4>
<p>Für <em>Private Key</em> und <em>Public Key</em> müssen Sie mit <em>Generate Keypair</em> ein neues Schlüsselpaar generieren.</p>
<h3 id="windows-service">Windows-Service</h3>
<p>Hier können nur Änderungen vorgenommen werden, solange der Service nicht installiert worden ist.</p>
<p>Ändern Sie diese Einstellungen auch niemals manuell in der <code>AuthenticationService.exe.config</code>.
Ansonsten kann der Authentication-Service dem Windows-Dienst nicht mehr zugeordnet werden.</p>
<h4 id="service-name">Service Name</h4>
<p>Unter diesem Namen wird der Service in den Windows-Diensten registriert.
In dem Feld können Sie einen Namens-Zusatz angeben.
Das ist vor allem dann notwendig, wenn Sie mehrere Authentication-Services auf einem Rechner installieren, da der Name in den Windows-Diensten eindeutig sein muss.</p>
<h4 id="description">Description</h4>
<p>Dieses Feld wird als Description in den Windows-Diensten gespeichert.</p>
<h4 id="nachträgliche-änderung">Nachträgliche Änderung</h4>
<p>Wenn Sie diese Einstellung nachträglich ändern möchten, dann müssen Sie:</p>
<ul>
<li>den Dienst mit dem Link <strong>stop Service</strong> beenden,</li>
<li>ihn mit dem Link <strong>uninstall Service</strong> deinstallieren,</li>
<li>die Änderungen vornehmen und speichern und</li>
<li>den Dienst mit dem Link <strong>install Service</strong> wieder installieren.
Dabei sollte der Benutzer-Account des Dienstes wieder der von vorher sein – ggf. vor der ganzen Aktion merken.</li>
</ul>
<p>Speichern Sie die Änderungen mit <em>Save Changes</em> ab.</p>
<h2 id="registerkarte-application-security">Registerkarte Application Security</h2>
<p>Auf der Registerkarte <strong>Application Security</strong> können erweiterte Sicherheitsanforderungen und die gewünschte Form der Authentification, die für Ihre Anwendungen gelten sollen, konfiguriert werden.</p>
<p><img src="media/ApplicationSecurity.png" alt="Authentication Service Configuration Editor"></p>
<h3 id="general-settings">General Settings</h3>
<h4 id="maximum-username-length">Maximum username length</h4>
<p>Hier können Sie die vom Authentifizierungsdienst geduldete Maximallänge für Benutzernamen ändern.</p>
<h4 id="set-defaults">Set Defaults</h4>
<p>Mit <em>Set Default</em> werden die Standardeinstellungen dieser Registerkarte wiederhergestellt.</p>
<h4 id="enable-advanced-security">Enable advanced Security</h4>
<p>Mit dem Schalter <strong>Enable advanced security</strong> legen Sie fest, ob die erweiterten Sicherheitseinstellungen in der <a href="#user-password-authentication">User Password Authentication</a> grundsätzlich aktiviert werden sollen. Wenn Sie diese nicht aktivieren, sind alle weiteren darin enthaltenden Einstellungen des Abschnittes bedeutungslos.</p>
<h3 id="openid-connect-authentication">OpenID Connect Authentication</h3>
<p>Im darauf folgenden Abschnitt <em><strong>OpenID Connect Authentication</strong></em> kann die Authentification per OpenIDConnect konfiguriert werden.
Beachten Sie die <a href="oidc.html#einrichtung">Dokumentation für die Einrichtung von OpenID Connect</a>.
Mit <strong>Oidc Active</strong> kann man steuern, ob OpenID Connect verwendet werden soll (default, wenn nicht angegeben, ist <code>true</code>).
Hierfür sind <strong>Identity Provider URL</strong> und <strong>ClientID</strong> erforderlich. Das <strong>ClientSecret</strong> ist empfohlen, aber nicht zwingend notwendig.
Falls ein <strong>ClientSecret</strong> genutzt wird, wird auch empfohlen die <strong>Client Secret Expiration</strong> zu setzen.
Optional sind zudem der <strong>Scope</strong> (default, wenn nicht angegeben, ist 'openid profile email') und <strong>Claim</strong> (default, wenn nicht angegeben, ist 'email'). Das <strong>Label for Claim</strong> ist optional und wird, wenn angegeben, in die Runtime Administration übernommen.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Beachten Sie hierbei die jeweiligen Anforderungen des Identity Providers, den Sie nutzen wollen. Dieser kann teilweise andere Scopes oder Claims bzw. ein valides ClientSecret voraussetzen.</p>
</div>
<h3 id="domain-authentication">Domain Authentication</h3>
<p>Die Domain Authentication widerrum ermöglicht Windows-Authentifizierung. Es ist entweder eine Authentification per Domain oder OpenID Connect möglich.</p>
<h4 id="domain-controller">Domain controller</h4>
<p>Das Eingabefeld <strong>Domain controller</strong> muss leer bleiben, wenn die Authentifizierung beim Start der Endanwendung nicht automatisch mit den angemeldeten Windows-Benutzern erfolgen soll.
Andernfalls muss hier der zu verwendende Domain Controller (DC) angegeben werden (z.B. mydc.mycompany.com).</p>
<h4 id="domain">Domain</h4>
<p>Das Eingabefeld <strong>Domain</strong> muss ebenfalls leer bleiben, wenn die Authentifizierung beim Start der Endanwendung nicht automatisch mit dem angemeldeten Windows-Benutzer erfolgen soll.
Andernfalls muss hier in Großbuchstaben der Name der Domäne angegeben werden (z.B. MYDOMAIN).
Die Authentifizierung über die Domäne kann nur dann funktionieren, wenn Client und Authentication Service zur angegebenen Domäne gehören.</p>
<h3 id="user-password-authentication">User Password Authentication</h3>
<p>Bereich <em><strong>User Password Authentication</strong></em> zur Authentification per Benutzername-Passwort-Kombination enthält folgende Einstellungen im Einzelnen:</p>
<h4 id="enforce-character">Enforce character</h4>
<p>Erzwingt, dass in jedem Passwort mindestens ein Buchstabe vorkommen muss.</p>
<h4 id="enforce-upper-and-lower">Enforce upper and lower</h4>
<p>Erzwingt, dass in jedem Passwort mindestens ein Groß- und ein Kleinbuchstabe vorkommen muss.</p>
<h4 id="enforce-special-character">Enforce special character</h4>
<p>Erzwingt, dass in jedem Passwort mindestens ein Sonderzeichen vorkommen muss. Welche Zeichen als Sonderzeichen erkannt werden, definieren Sie im Textfeld <strong>Special characters</strong>.</p>
<h4 id="enforce-number">Enforce number</h4>
<p>Erzwingt, dass in jedem Password mindestens eine Ziffer vorkommen muss.</p>
<h4 id="minimum-length">Minimum length</h4>
<p>Legt die Mindestlänge für Passworte fest.</p>
<h4 id="exclusion-list">Exclusion list</h4>
<p>Durch Leerzeichen getrennt können Sie hier Worte definieren, die im Passwort (unabhängig von der Groß-Kleinschreibung) nicht vorkommen dürfen. <code>username</code> steht dabei für den Namen des Benutzers.</p>
<h4 id="contains-excluded">Contains excluded</h4>
<p>Wenn diese Checkbox gesetzt ist, werden alle Passworte abgelehnt, in denen eines der Worte aus der <strong>Exclusion list</strong> vorkommt. Ist die Checkbox nicht gesetzt, werden nur die Passworte abgelehnt, die mit einem Wort aus der <strong>Exclusion list</strong> übereinstimmen.</p>
<h4 id="prohibit-recent">Prohibit recent</h4>
<p>Wenn ein Benutzer sein Passwort ändert, können die letzten x Passworte des Benutzers als neues Passwort gesperrt werden.</p>
<h4 id="minimum-change-period">Minimum change period</h4>
<p>Minimale Gültigkeitsdauer von Passworten in Tagen.</p>
<h4 id="maximum-change-period">Maximum change period</h4>
<p>Maximale Gültigkeitsdauer von Passworten in Tagen.</p>
<h4 id="maximum-failed-logins">Maximum failed logins</h4>
<p>Anzahl der nicht erfolgreichen Anmeldeversuche, nach welcher der Benutzerzugang temporär gesperrt wird.</p>
<h4 id="lock-time">Lock time</h4>
<p>Zeit (im Format Stunden:Minuten:Sekunden), die ein Benutzerzugang gesperrt wird, wenn die maximale Anzahl von nicht erfolgreichen Anmeldeversuchen erreicht ist.</p>
<p>Speichern Sie Ihre Änderungen mit <strong>Save Changes</strong>.</p>
<h2 id="registerkarte-runtime-supervisor">Registerkarte Runtime Supervisor</h2>
<p>Auf der Registerkarte <strong>Runtime Supervisor</strong> kann angegeben werden, an welchem Runtime Supervisor sich der Authentication Service registrieren soll.</p>
<p><img src="media/RuntimeSupervisor.png" alt="Authentication Service Configuration Editor Registerkarte Runtime Supervisor"></p>
<h4 id="checkbox-enable">Checkbox Enable</h4>
<p>Diese Checkbox muss gesetzt werden, damit der Runtime Supervisor aktiviert wird.</p>
<h4 id="runtime-supervisor-url">Runtime Supervisor Url</h4>
<p>Hier können der Server und der Port angegeben werden. Die vollständige URL wird automatisch aufgebaut. Mit dem Button <strong>Test</strong> kann versucht werden, ob eine Verbindung zum Runtime Supervisor aufgebaut werden kann.</p>
<p>Nähere Informationen dazu sind in der Dokumentation des <a href="../runtimesupervisor/runtimesupervisor-common.html">Runtime Supervisor</a> zu finden.</p>
<p>Speichern Sie Ihre Änderungen mit <strong>Save Changes</strong>.</p>
<h2 id="installation-fortfahren">Installation fortfahren</h2>
<ol>
<li><p>Jetzt müssen Sie das Programm als Dienst im Betriebssystem registrieren. Klicken Sie dazu den Link <strong>install Service</strong></p>
</li>
<li><p>Sie erhalten folgendes Bild:</p>
<p><img src="media/StartupAccount.png" alt="Startup Account for Authentication Service"></p>
<p>Geben Sie hier den Benutzer an, mit welchem der Dienst ausgeführt werden soll.</p>
<p>Es wird empfohlen nach Möglichkeit einen Domain-User anzugeben, da die System-Konten standardmäßig nicht über die notwendigen Rechte verfügen.
Wählen Sie dazu <em>User</em> aus und geben Sie in <em>User credentials</em> die Benutzerdaten an.</p>
<p>Der <em>User</em> muss im Format <code>Domain\User</code> angegeben werden.</p>
<p>Je nach Konfiguration des Systems kann ggf. auch eines der Systemkonten verwendet werden.</p>
<p>Diese Routine erzeugt einige Protokoll-Dateien über den Installationsverlauf im Zielordner. Diese sind kein Problem.</p>
</li>
<li><p>Überprüfen Sie ggf. ob der Dienst erfolgreich installiert wurde.
Im oberen Teil des Fensters sollten Sie folgendes Bild sehen:</p>
<p><img src="media/RunningService.png" alt="Authentication Service Configuration Editor Registerkarte General"></p>
</li>
<li><p>Mögliche Gründe für das Fehlschlagen der Installation:</p>
<ul>
<li>Die Konfiguration ist fehlerhaft. Prüfen Sie die Angaben*.*</li>
<li>Der angegebene Benutzer hat nicht die notwendigen Rechte. Prüfen Sie ggf. das Ereignisprotokoll.</li>
</ul>
</li>
</ol>
<h2 id="deinstallation">Deinstallation</h2>
<div class="WARNING">
<h5>Warning</h5>
<p>Es gehen die Einstellungen aus der Konfigurations-Datei <code>AuthenticationService.exe.config</code> verloren. Sichern Sie diese ggf. vorher.</p>
</div>
<ol>
<li>Starten Sie das Programm <code>AuthenticationServiceConfigEditor.exe</code>.</li>
<li>Wenn der Dienst noch gestartet ist, stoppen Sie ihn mit dem Link <strong>stop Service</strong>.</li>
<li>Klicken Sie den Link <strong>uninstall Service</strong> um den Dienst aus den Windows-Diensten zu entfernen.</li>
<li>Löschen Sie den Zielordner.</li>
</ol>
<h2 id="client-konfiguration">Client Konfiguration</h2>
<p>Wenn Sie den Authentifizierungsdienst von einem Client aus ansprechen wollen, muss dort der Service-Endpoint entsprechend konfiguriert sein.</p>
<h3 id="mit-framework-studio-erstellte-anwendungen">Mit Framework Studio erstellte Anwendungen</h3>
<p>In Framework Studio finden Sie in den <a href="../publish-wizards/publish-wizard.html">Publish Wizard</a> drei Stellen, an denen Sie Angaben zum Authentifizierungsdienst machen müssen.</p>
<ol>
<li>Im Bereich <a href="../publish-wizards/publish-wizard.html#authentication">Authentication</a> werden Standardbenutzer und dessen Passwort sowie die ID des Authentifizierungsdienstes festgelegt.</li>
<li>Im Bereich <a href="../publish-wizards/publish-wizard.html#service-proxies">Service Proxies</a> geben Sie am <em>AuthServiceProxy</em> die zu verwendende Endpunktadresse an.</li>
<li>Bei allen Anwendungen und Diensten finden Sie einen Bereich <a href="../publish-wizards/publish-wizard.html#registerkarte-authentication">Authentication</a>, in dem alle Angaben zur Identifikation des Clients festgelegt werden.</li>
</ol>
<h3 id="runtime-administration">Runtime Administration</h3>
<p>Beim Start der <a href="../runtime-administration/runtime-administration-config.html">Runtime-Administration</a> muss der Servername und ggf. der Port angegeben werden.</p>
<h2 id="start-aus-der-console">Start aus der Console</h2>
<p>Der Authentication Server muss nicht zwingend als Windows Dienst installiert und gestartet werden.
Insbesondere zu Testzwecken besteht folgende Möglichkeit, um den Authentication Service zu starten:</p>
<p>Rufen Sie die Datei <code>AuthenticationService.exe</code> auf.
Alle Meldungen des Services werden in das Console-Fenster ausgegeben.
Zum Stoppen des Services drücken Sie im Console-Fenster die Eingabetaste.</p>
<p>Beachten Sie bitte, dass der manuelle Start des Authentication Services Administratorrechte erfordert.</p>

</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span><a href="https://www.enventa-group.com/" target="_blank" rel="noopener noreferrer nofollow"><img class="dark" src="../../media/enventa-group-logo-dark.svg" alt="enventa-group" style="height: 1.5rem"><img class="light" src="../../media/enventa-group-logo.svg" alt="enventa-group" style="height: 1.5rem"></a></span> <span style="float:right">Made with <a href="https://dotnet.github.io/docfx" target="_blank" rel="noopener noreferrer nofollow" class="external">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
